在 Makefile 中，这些以 `$` 开头的符号被称为**自动变量（Automatic Variables）**。它们是 Makefile 的灵魂，能让你编写极其通用的规则，而不需要为每个文件硬编码名称。

以下是这些特殊变量的详细汇总和用法说明：

### 1. 最常用的核心变量

| 变量 | 说明 | 记忆技巧 |
| :--- | :--- | :--- |
| **`$@`** | **目标文件 (Target)** 的完整名称。 | 在“目标”上。 |
| **`$<`** | **第一个依赖文件 (Prerequisite)** 的名称。 | 依赖项中的“头一个”。 |
| **`$^`** | **所有依赖文件** 的列表（自动去重，空格分隔）。 | 向上（所有依赖项）。 |
| **`$+`** | **所有依赖文件** 的列表（**不去重**，包含重复项）。 | 所有的加在一起。 |
| **`$?`** | 所有**比目标文件更新**的依赖文件列表。 | 谁（Which）更新了？ |
| **`$*`** | 匹配模式规则中的 **“茎”（Stem）**（即 `%` 匹配的部分）。 | 核心部分。 |

---

### 2. 详细用法示例

假设我们有以下 Makefile 片段：

```makefile
# 目标是 main
# 依赖项是 main.o utils.o
main: main.o utils.o
	gcc -o $@ $^
```
*   **`$@`** 解析为 `main`
*   **`$^`** 解析为 `main.o utils.o`
*   命令等同于：`gcc -o main main.o utils.o`

---

#### 示例：编译 `.o` 文件
```makefile
%.o: %.c
	gcc -c $< -o $@
```
*   如果你正在编译 `hello.c`：
    *   **`$@`** 是 `hello.o`
    *   **`$<`** 是 `hello.c`
    *   **`$*`** 是 `hello`（`%` 匹配的部分）

---

#### 示例：仅处理更新过的文件 (`$?`)
如果你只想把自上次打包以来修改过的文件存入存档：
```makefile
libdata.a: data1.txt data2.txt data3.txt
	ar r $@ $?
```
*   如果只有 `data2.txt` 修改了，那么 `$?` 就只有 `data2.txt`，`ar` 命令只更新这一个文件。

---

### 3. 进阶：提取目录与文件名
有时你需要获取路径或文件名，可以在变量后加 `D` (Directory) 或 `F` (File)：

*   **`$(@D)`**: 目标文件所在的目录部分。
*   **`$(@F)`**: 目标文件的文件名部分（不含目录）。

**示例：**
如果目标是 `src/obj/main.o`：
*   `$@` 为 `src/obj/main.o`
*   `$(@D)` 为 `src/obj`
*   `$(@F)` 为 `main.o`

---

### 4. 其他特殊的预定义变量

除了自动变量，Makefile 还有一些约定俗成的预定义变量：

1.  **`$(MAKE)`**: 
    指向当前使用的 `make` 工具。建议在递归调用子目录的 Makefile 时使用 `$(MAKE) -C subdir`，而不是直接写 `make`。
2.  **`$(CC)` / **`$(CXX)`**: 
    默认指向 `cc` (C 编译器) 或 `g++` (C++ 编译器)。
3.  **`$(CFLAGS)` / `$(CPPFLAGS)`**: 
    C 编译器的参数（如 `-g`, `-O2`）和 C 预处理器的参数（如 `-I` 包含路径）。
4.  **`$(RM)`**: 
    默认指向 `rm -f`。

---

### 5. 总结速查表

| 变量 | 含义 |
| :--- | :--- |
| **`$@`** | 目标 (Target) |
| **`$^`** | 所有依赖 (All prerequisites, unique) |
| **`$<`** | 第一个依赖 (First prerequisite) |
| **`$*`** | `%` 匹配的内容 |
| **`$?`** | 比目标新的依赖 |
| **`$+`** | 所有依赖 (含重复项) |

**建议：** 编写 Makefile 时，尽量多使用这些变量，这样当你修改文件名或增加依赖时，不需要去每一行改写具体的命令，极大地增强了代码的可维护性。